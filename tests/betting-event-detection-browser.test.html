<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betting Event Detection System Tests</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: #ffffff;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }
        .test-container {
            background-color: #2d2d2d;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .test-output {
            background-color: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            border: 1px solid #333;
        }
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
            transition: transform 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
        }
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .summary {
            background-color: #2d2d2d;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        .summary.success {
            border-left: 5px solid #4CAF50;
        }
        .summary.failure {
            border-left: 5px solid #f44336;
        }
        .summary-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
        }
        .stat-label {
            font-size: 14px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ Betting Event Detection System Tests</h1>
        <p>Testing the centralized betting event detection and classification system</p>
    </div>

    <div class="controls">
        <button id="runTestsBtn" class="btn">Run All Tests</button>
        <button id="clearOutputBtn" class="btn">Clear Output</button>
    </div>

    <div class="test-container">
        <h2>Test Output</h2>
        <div id="testOutput" class="test-output">Click "Run All Tests" to start testing the betting event detection system...</div>
    </div>

    <div id="testSummary" class="summary" style="display: none;">
        <h2>Test Summary</h2>
        <div id="summaryContent"></div>
        <div class="summary-stats">
            <div class="stat">
                <div id="totalTests" class="stat-number">0</div>
                <div class="stat-label">Total Tests</div>
            </div>
            <div class="stat">
                <div id="passedTests" class="stat-number">0</div>
                <div class="stat-label">Passed</div>
            </div>
            <div class="stat">
                <div id="failedTests" class="stat-number">0</div>
                <div class="stat-label">Failed</div>
            </div>
        </div>
    </div>

    <script type="module">
        // Override console.log to capture output
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        let testOutput = '';

        function captureConsole() {
            testOutput = '';
            console.log = (...args) => {
                testOutput += args.join(' ') + '\n';
                originalConsoleLog(...args);
            };
            console.error = (...args) => {
                testOutput += 'ERROR: ' + args.join(' ') + '\n';
                originalConsoleError(...args);
            };
        }

        function restoreConsole() {
            console.log = originalConsoleLog;
            console.error = originalConsoleError;
        }

        function updateOutput(content) {
            document.getElementById('testOutput').textContent = content;
        }

        function showSummary(summary) {
            const summaryDiv = document.getElementById('testSummary');
            const summaryContent = document.getElementById('summaryContent');
            
            summaryDiv.style.display = 'block';
            summaryDiv.className = `summary ${summary.failed > 0 ? 'failure' : 'success'}`;
            
            document.getElementById('totalTests').textContent = summary.total;
            document.getElementById('passedTests').textContent = summary.passed;
            document.getElementById('failedTests').textContent = summary.failed;
            
            if (summary.failed > 0) {
                const failedTests = summary.results.filter(r => r.status === 'FAIL');
                summaryContent.innerHTML = `
                    <p><strong>‚ùå ${summary.failed} test(s) failed:</strong></p>
                    <ul>
                        ${failedTests.map(test => `<li>${test.description}: ${test.error}</li>`).join('')}
                    </ul>
                `;
            } else {
                summaryContent.innerHTML = `<p><strong>‚úÖ All tests passed successfully!</strong></p>`;
            }
        }

        async function runTests() {
            const runBtn = document.getElementById('runTestsBtn');
            runBtn.disabled = true;
            runBtn.textContent = 'Running Tests...';
            
            try {
                updateOutput('Starting betting event detection tests...\n');
                
                captureConsole();
                
                // Import and run the test suite
                const { runBettingEventDetectionTests } = await import('./betting-event-detection-simple.test.js');
                const summary = await runBettingEventDetectionTests();
                
                restoreConsole();
                
                updateOutput(testOutput);
                showSummary(summary);
                
            } catch (error) {
                restoreConsole();
                updateOutput(`Error running tests: ${error.message}\n\nStack trace:\n${error.stack}`);
                console.error('Test execution error:', error);
            } finally {
                runBtn.disabled = false;
                runBtn.textContent = 'Run All Tests';
            }
        }

        function clearOutput() {
            updateOutput('Output cleared. Click "Run All Tests" to start testing...');
            document.getElementById('testSummary').style.display = 'none';
        }

        // Event listeners
        document.getElementById('runTestsBtn').addEventListener('click', runTests);
        document.getElementById('clearOutputBtn').addEventListener('click', clearOutput);

        // Auto-run tests on page load
        window.addEventListener('load', () => {
            setTimeout(runTests, 1000);
        });
    </script>
</body>
</html>